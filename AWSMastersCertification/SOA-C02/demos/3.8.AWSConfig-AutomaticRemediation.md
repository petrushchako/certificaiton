# Demo:<br>Configuring Automatic Remediation using Systems Manager and AWS Config

![](../img/demo/3.8.AWSConfig-AutomaticRemediation.png)

<br>

### Lesson Objectives
1. **Launch Two EC2 Instances**<br>One will be Amazon Linux and the other will be RedHat
2. **Create an AWS Config Rule**<br>Create a rule in AWS Config which checks that all EC2 instances are running Amazon Linux
3. **After the Rule Is Evaluated**<br>Config should report that we have one instance that is compliant and one that is non-compliant
4. **Config Automatic Remediation**<br>Configure AWS Config to automatically stop the non-compliant instances (under the hood, it is using AWS Systems Manager)

<br>

### Lesson Prerequisite

#### Prerequisite: **An IAM role is required**

> Will be configured using a script<br>https://raw.githubusercontent.com/ACloudGuru-Resources/course-aws-sysops-administrator-associate/main/Automation_With_AWS_Config_Demo/roleconfig.sh
- **Name**: `MyAutomationRole`
- **Managed policy**: `AmazonSSMAutomationRole`<br>This contains the permissions required to stop an EC2 instance
- **Inline policy**: Allows this role to be passed to another service
- **Trust policy**: `Allows Systems Manager and EC2 to assume the role`.<br>This enables EC2 to register the Systems Manager, and Systems Manager to stop the EC2 instance.

<br>


## Solution
1. **Launch Two EC2 Instances**
    - In `EC2` create 2 instances (with dofference being two different OS platforms):
      - Amazon Linux 2
      - Red Hat Enterprise Linux
    - Type: `t3.micro`
    - Proceed without a key pair

    > **AMI ID**<br>
    > Take a note of Amazon Linux 2 AMI ID. It will be used later during setup of AWS Config Rule<br><br>

2. **Create an AWS Config Rule**



3. **After the Rule Is Evaluated**



4. **Config Automatic Remediation**


