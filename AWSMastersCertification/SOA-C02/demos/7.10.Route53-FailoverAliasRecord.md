# Demo:<br>Configuring Route 53 Failover Alias Records

<br>

![](../img/demo/7.10.Route53-FailoverAliasRecord.png)

<br>

### Objectives
- **Launch an EC2 Instance**<br>Install `httpd`
- **Create an S3 Bucket**<br>Enable static wesite hosting
- **Configure a Failover Record Set**<br>The primary target will be our Ec2 Instance. The secondary target is going to be our S3 hosted website

<br><br>

## Solution
### **Launch EC2 Instance (Primary Target):**
1. From AWS Console, go to **EC2** → **Launch Instance**.
2. Name: `WS1`.
3. AMI: **Amazon Linux**.
4. Instance Type: `t3.micro`.
5. Network settings:
   - Allow HTTP traffic from the internet.
   - No SSH access required.
6. Advanced settings → User Data:  
   - Paste the provided **bootstrap script** to install and configure `httpd`:

    ```sh
    #!/bin/bash	
    dnf update -y
    dnf install httpd -y
    echo "<html><body><h1>Hello Cloud Gurus - This web page is being served from EC2.</h1></body></html>" >/var/www/html/index.html
    systemctl start httpd
    systemctl enable httpd
    ```

<br>

### **Configure S3 Bucket (Secondary Target):**
1. Go to **Route 53** → Copy your hosted zone name.
2. Open **S3** → **Create Bucket**:
   - **Bucket Name**: Same as your hosted zone name.
   - **Region**: `us-east-1`.
   - Disable **Block Public Access Settings**.
   - Acknowledge and create the bucket.

### **Static Website Hosting:**
1. Upload `index.html` to your bucket:
   - Add file: `index.html` (resource provided).
   - Upload.
2. Add Bucket Policy:
   - Paste the provided policy, replacing `<BUCKET_NAME>` with your bucket name.

    ```json
    {
        "Id": "Policy1675093308212",
        "Version": "2012-10-17",
        "Statement": [
            {
            "Sid": "Stmt1675093303975",
            "Action": [
                "s3:GetObject"
            ],
            "Effect": "Allow",
            "Resource": "arn:aws:s3:::<BUCKET_NAME>/*",
            "Principal": "*"
            }
        ]
    }
    ```

   - Ensure the policy applies to all objects (`/*`).
3. Enable Static Website Hosting:
   - Go to **Properties** → Enable Static Website Hosting.
   - **Index Document**: `index.html`:

    ```html
    <html><body><h1>Hello Cloud Gurus - This web page is hosted in S3.</h1></body></html>
    ```

4. Test: Copy the **bucket website endpoint**, paste it in a browser, and verify.

<br>

### **Verify EC2 Instance:**
- Go to **EC2**, copy the **Public IP Address**, and paste it into a browser.
- Confirm that the web page is being served.

<br>
