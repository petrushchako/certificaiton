# CHAPTER 5<br>Reliability and Business Continuity

### Chapter Outline
- Section Introduction
- Elasticity and Scalability 101
- Introducing AWS Auto Scaling
- `Demo` Creating Auto Scaling Plans
- Troubleshooting Auto Scaling Issues
- Vertical Scaling vs. Horizontal Scaling
- Using AWS ElastiCache
- Aurora 101
- `HANDS-ON LAB` Creating an Amazon Aurora RDS Database (MySQL Compatible)
- Understanding Aurora Auto Scaling Options
- RDS and Multi-AZ Failover
- RDS and Read Replicas
- `HANDS-ON LAB` Deploy an Amazon RDS Multi-AZ and Read Replica in AWS
- `Demo` Creating and Encrypting RDS Snapshots
- Differentiating Single Availability Zones vs. Multi-AZ Deployments
- Implementing Fault Tolerant Workloads Using Amazon Elastic File System (EFS)
- Building Fault Tolerance Using Elastic IPs
- Readying for Disaster Recovery
- AWS Service Maintenance Windows
- Configuring S3 Cross-Region Replication
- Implementing Loosely Coupled Architectures with SQS
- `Demo` Automating EBS Snapshots Using Data Lifecycle Manager
- Using DynamoDB Streams for Backing Up Your Table to Another Region

<br><br><br>

## Section Introduction
- Elasticity and Scalability
- Auto Scaling in AWS
- Horizontal and Vertical Scaling
- ElastiCache
- RDS
- High Availability
- Fault Tolerance and Disaster Recovery

<br><br>

## Elasticity and Scalability 101
### What is Elasticity?
- Stretching and retracting your infrastructure based on demand(**Short term**)
- Allow you to **pay as you go**
- Typically used during a short period of time, hours or days

### What is Scalability?
- Building your infrastructure to meet your demands over **longer time**

### AWS Services: ELasticity vs Scalability
||**Elasticity**|**Scalability**|
|---|---|---|
|**EC2**|Configure Auto Scaling to increase and decrease the number of EC2 instance|Increase instance sizes<br>Use Reserved instances|
|**DynamoDB**|Increase/decrease IOPS based on traffic spikes|Unlimited amount of storage|
|**RDS**|Can't scale on demand|Increase instance size<br>Add number of instances|
|**Amazon Aurora**|Autoscale up or down to meet varying demand on the database|Modify the instance type|

<br><br><br>

## Introducing AWS Auto Scaling

> ![Youtube tutorial](https://www.youtube.com/watch?v=xQeGrgQJJDc&t=227s)

### What is AWS Auto Scaling?
An AWS Service which allows you to configure pland to automatically scale your resources
- EC2 Auto Scaling launches and terminates instances dynamically
- Scaling is horizontal (scales out)
- Provides elasticity and scalability
- Responds to EC2 status checks and CloudWatch metrics
- Can Scale based on demand (performance) or on a schedule
- Auto scaling group definescollection of EC2 instances that are scaled and managed together

### Understanding Scaling Plans
- **Scaling Plans**<br>A set of directions for scaling your resources.
- **Scaling Strategy** (within scaling plan)<br>Instructs AWS Auto Scaling on how to optimize resources in your scaling plan for availability, cost or both.
- There are three types of scaling available:
    - **Dynamic Scaling** - automatically scales based on demand
    - **Predictive Scaling** - uses Machine Learning to predict
    - **Scheduled** - scales based on a schedule

### Creating Scaling Plans
- **Cloud Formation Scripting**<br>**Find scalable resources** through existing CloudFormation templates
- **EC2 Auto Scaling Group**<br>**Select one or more** existing EC2 Auto Scaling groups to be included in your scaling plans
- **Tagged Resources**<br>**Search for scalable resources** using the tags applied to them


### Scalable AWS Services
|Service|Description|
|---|---|
|**EC2**|Maintain an Auto Scaling group through launching or terminating instances|
|**DynamoDB**|Enable tables or secondary indexes to increase or decrease read and write capacity|
|**Elastic Container Services**|Adjust ECS service count up/down|
|**Aurora**|Automatically adjust the number of read replicas in the Aurora DB cluster|

### Health Checks
- EC2 = EC2 status checks
- ELB = Uses the ELB health checks in addition to EC2 status checks
  
### Health check grace period
- How long to wait before checking the health status of the instance
- Auto Scaling does not act on health checks until grace period expires

### Types of policies
- **Target tracking scaling** - Increase and decrease the current capacity of the group based on an Amazon Cloud Watch metric and a target value. E.g., keeping the aggregate CPU usage of your ASG at 70%
- **Step scaling** - Increase and decrease the current capacity of the group based on a set of scaling adjustments, known as step adjustments, that vary based on the size of the alarm breach
- **Simple scaling** - Increase and decrease the current capacity of the group based on a single scaling adjustment, with cooldown period between each scaling activity

### Auto Scaling - Monitoring
#### Group metrics (ASG)
- Data points about the Auto Scaling group
- 1-minute granularity
- No charge
- Must be enabled
#### Basic monitoring (Instances)
- 5-minute granularity
- No Charge
#### Detailed monitoring (Instances)
- 1-minute granularity
- Charges apply


### Additional Scaling Settings
- **Cooldowns** - Used with simple scaling policy to prevent Auto Scaling from launching or terminating before effects of previous activities are visible. Default value is 300 seconds (5 minutes)
- **Termination Policy** - Controls which instances to terminate first when a scale-in event occurs 
- **Termination Protection** - Prevents Auto Scaling from terminating protected instances
- **Standby State** - Used to put an instance in the InService state into the Standby state, update or troubleshoot the instance
- **Lifecycle Hooks** Used to perform custom actions by pausing instances as the ASG launches or terminates them
- Use case:
    - Run a script to download and install software after launching
    - Pause an instance to process data before a scale-in (termination