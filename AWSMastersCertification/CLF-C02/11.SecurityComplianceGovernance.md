# Security, Compliance and Governance

- Security: The Bigger Picture
- What Do We Need To Secure on AWS?
- Illustrating the Principle of Least Privilege
- What Is IAM?
- `HANDS-ON LAB`<br>Troubleshooting an IAM Policy on an EC2 Instance
- Leveraging Existing Identity Providers
- Keeping Secrets Safe
- Exploring Network Security Services
- What Is Security Hub?
- `Demo`<br>Exploring Security Hub
- Responding to Security Events
- Growing Your Security Muscles
- Governing Multiple Accounts on AWS
- Understanding Compliance on AWS

<br>

## Security: The Bigger Picture

### Key Considerations

Securing cloud environments hinges on addressing two fundamental questions:

1. **Who can access?**
   - Define and manage user identities and roles.
   - Implement strong authentication mechanisms.

2. **What can they do?**
   - Assign permissions and policies to control actions.
   - Enforce the principle of least privilege to minimize access.

By focusing on these aspects, you can effectively safeguard your cloud infrastructure against unauthorized access and actions.

### The Shared Responsibility Model

![](img/SharedResponsibilityModel.png)


### The Well-Architected Framework: Security

![](img/WellArchitectedFramework-Security.png)

Here are a few key tenets of Security pillar:
- Identity and Access Management
- Data Stewardship and Encryption
- Network Security
- Application Security
- Compliance
- Security Management

<br>



## What Do We Need To Secure on AWS?

The Shared Responsibility Model:
- **Customer** (responsibility for security `in` the cloud):
  - **Customer Data** (Retention, Encryption, Backups, Access)
  - **Platform, Applications, Identity & Access Managment**
  - **Operating System, Networking & Firewall Configuration**
  - **Encryption**:
    - Client-Side Data Encryption & Data Integrity Authentication
    - Server-Side Encryption (File System and/or Data)
    - Networking Traffic Protection (Encryption, Integrity, Identity)
- **AWS** (responsibility for security `of` the cloud)
  - **Managed Services** lets you transfer responsibility of Operating System, Networking, Firewall and Encryption to AWS (instead of managing it as a customer).
  <br>Example:<br>
  You could choose to host database from `EC2` instance, where OS, Networking,etc would be your responsibility. Or you could choose to use managed DB instance on AWS (i.e. `RDS`)
    ![](img/Responsibility-ManagedServices.png)


<br>





## Illustrating the Principle of Least Privilege

### Introduction

Before diving into the security services on AWS, it's crucial to understand the Principle of Least Privilege. This principle ensures that users and resources are granted only the permissions necessary to complete their tasks. Let's explore this concept using the World Pizza Company as an example.

### What is the Principle of Least Privilege?

The Principle of Least Privilege states that you should grant only the permissions needed to complete a task. This minimizes the risk of unauthorized access and accidental changes to sensitive data or critical systems.

### Examples from World Pizza Company

World Pizza Company has various resources:
- Front door (access control)
- Pizza oven (production)
- Point-of-sales system (orders)
- Safe (secret recipe storage)

Hereâ€™s how the Principle of Least Privilege applies to different employees:

1. **Pizza Cook**
   - Needs access only to the pizza oven.
   - Does not require access to the front door, point-of-sales system, or the safe.

2. **Customer Service Employee**
   - Needs access only to the point-of-sales system to take orders.
   - Does not require access to the pizza oven, front door, or the safe.

3. **Manager**
   - Needs access to the front door to open the store.
   - May need access to the point-of-sales system and pizza oven.
   - Does not require access to the safe.

4. **Owner (Sage)**
   - Needs access to all resources, including the front door, pizza oven, point-of-sales system, and the safe.

### Importance of the Principle of Least Privilege

#### Risk Mitigation

By applying the Principle of Least Privilege, the potential impact of a compromised identity is minimized. For instance, if a bad actor impersonates the pizza cook, they would only have access to the pizza oven, not to the safe or point-of-sales system, thereby reducing the risk of significant damage.

#### Preventing Accidents

Limiting access also reduces the likelihood of accidental data exposure or system misconfiguration. Fewer permissions mean fewer chances for unintended actions that could lead to security breaches.

### Granular Permissions

Granular permissions allow you to specify precise actions that users or applications can perform. For example:

- **Point-of-Sales System**
  - Employees: Can enter orders, open the cash drawer, edit menu items, refund transactions, and receive payments.
  - Customers: Can only place orders and make payments.

### Identity and Access Management (IAM) on AWS

IAM (Identity and Access Management) is the AWS service that helps you apply the Principle of Least Privilege by managing permissions for users, resources, and applications.

- **Users**: Define permissions for AWS users logging into your account.
- **Resources**: Restrict access to specific AWS resources.
- **Applications**: Grant applications permissions to access resources within AWS.

### Conclusion

By adhering to the Principle of Least Privilege and leveraging IAM, you can effectively control who can enter your AWS environment and what actions they can perform. This approach enhances security by minimizing both the risk of unauthorized access and the potential for accidental damage.



<br>



## IAM: Identity and Access Management
### Introduction
IAM (Identity and Access Management) is a crucial AWS service for controlling user access to your AWS account and resources. It ensures that the right people and resources have the appropriate access levels.

### Root User and Multi-Factor Authentication (MFA)
- **Root User**: The root user is the initial user created when setting up your AWS account. It has unrestricted access and is the only user capable of deleting the account. Keeping the root user secure is paramount.
- **Multi-Factor Authentication (MFA)**: MFA adds an extra layer of security. Even if an attacker obtains your username and password, they can't access your account without the MFA device. Enforcing MFA through IAM ensures only authenticated users can log in.

### Granular Permissions with IAM
IAM enables the definition of granular permissions. For example, at World Pizza Company:

- **Employees**: Can enter orders, open the cash drawer, change menu items, reverse transactions, and process payments.
- **Customers**: Can only place orders or make payments.

IAM policies define these permissions in AWS.

### IAM Policies
IAM policies are JSON documents that specify permissions for entities (users, groups, or roles). Here's a simple example:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": "s3:*",
      "Resource": "arn:aws:s3:::example-bucket/*"
    }
  ]
}
```

This policy grants full access to an S3 bucket and its contents. Policies can be applied to:

- **IAM Users**: Directly granting permissions to individual users.
- **IAM Groups**: Simplifying management by applying policies to groups, which automatically apply to all group members.
- **IAM Roles**: Allowing AWS resources or applications to assume roles with specified permissions. Roles automatically rotate their access keys, enhancing security.

### Access Methods
IAM users can access AWS resources through:
- **Console**: Using a username and password.
- **Command Line Interface (CLI)**: Using access keys.

### Best Practices
- **Access Key Rotation**: Regularly rotate access keys to minimize security risks. Long-lasting access keys increase the chance of being leaked.
- **Use IAM Roles**: Roles automatically rotate their keys, providing better security for applications and resources.

### Additional IAM Tools
- **IAM Access Analyzer**: Identifies resources with external access, validates policies, and generates policies based on usage to adhere to the principle of least privilege.
- **IAM Policy Simulator**: Allows testing policies before applying them to users, groups, or roles, ensuring they work as intended.

### Conclusion
IAM is essential for managing access and permissions in your AWS environment. By leveraging IAM policies, MFA, roles, and additional tools like Access Analyzer and Policy Simulator, you can ensure secure and efficient access control for all your AWS resources.